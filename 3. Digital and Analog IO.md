# Module 3 Lecture: Digital and Analog I/O in Arduino ⚡🔌
- 🤖Instructor: Md. Hassanul Karim Roni, Assistant Professor, EEE, HSTU,Dinajpur,BD


---

## 🎯 Lecture Objectives
- Understand digital and analog input/output operations in Arduino.  
- Learn Pulse Width Modulation (PWM) for analog-like control.  
- Use interrupts for responsive, event-driven programming.  
- Master timing with `delay()` and `millis()` for non-blocking code.  
- Build and test projects to control real-world hardware.
- Projects in this lecture: **💡potentiometer-controlled LED brightness**, **🚦traffic light simulator**

**Duration:** ~3 hours (1.5 hours lecture + 1.5 hours lab).  
**Tools Needed:** Arduino Uno, USB cable, LED (3 colors for traffic light), 220Ω resistors (3), potentiometer (10kΩ), push button, 10kΩ resistor, breadboard, jumper wires, laptop with Arduino IDE, optional: Tinkercad Circuits.  

---

## 🛠️ Why Digital and Analog I/O Matter
Arduino is all about talking to hardware—sensors send data (inputs), and actuators like LEDs or motors respond (outputs). Digital I/O handles simple on/off signals, while analog I/O deals with continuous values (like sensor readings or dimming lights). Mastering these lets you create responsive systems, from smart lights to robots! 🌟

---

## 📚 Digital and Analog I/O Concepts

### 1️⃣ Digital I/O
Digital pins handle binary signals: `HIGH` (5V) or `LOW` (0V).  

- **Functions:**  
  - `pinMode(pin, mode)`: Sets pin as `INPUT`, `OUTPUT`, or `INPUT_PULLUP`.  
  - `digitalWrite(pin, value)`: Sets pin to `HIGH` or `LOW`.  
  - `digitalRead(pin)`: Reads pin state (`HIGH` or `LOW`).  

- **Arduino Uno Pins:** 0-13 (avoid 0/1 for Serial).  
- **Use Cases:** LEDs, buttons, relays, buzzers.  

**Example: Button Toggle**
```c
const int buttonPin = 2;
const int ledPin = 13;

void setup() {
  pinMode(buttonPin, INPUT_PULLUP); // Internal pull-up resistor
  pinMode(ledPin, OUTPUT);
}

void loop() {
  if (digitalRead(buttonPin) == LOW) { // Button pressed
    digitalWrite(ledPin, HIGH);
  } else {
    digitalWrite(ledPin, LOW);
  }
}
```

**Technical Note:** `INPUT_PULLUP` uses internal resistors (~20kΩ) to avoid floating inputs, saving external components. Max pin current: 20mA.

---

### 2️⃣ Analog Input
Analog inputs read continuous signals (0-5V) as 10-bit values (0-1023).  

- **Function:** `analogRead(pin)`: Reads analog pins (A0-A5 on Uno).  
- **Use Case:** Sensors like potentiometers, LDRs, or temperature sensors.  
- **Example:** Read a potentiometer (0-1023 maps to 0-5V).  

**Code Snippet:**
```c
int sensorValue = analogRead(A0); // Read potentiometer
float voltage = sensorValue * (5.0 / 1023.0); // Convert to voltage
```

**Technical Note:** Uno’s ADC is 10-bit (1024 levels). Use `analogReference()` to adjust reference voltage (default 5V).

---

### 3️⃣ Analog Output (PWM)
Arduino fakes analog output using **Pulse Width Modulation (PWM)** on specific pins. PWM rapidly toggles a pin to simulate voltages (e.g., for LED dimming).  

- **Function:** `analogWrite(pin, value)`: Sets duty cycle (0-255, 0%-100%).  
- **PWM Pins (Uno):** 3, 5, 6, 9, 10, 11 (~490Hz frequency).  
- **Use Case:** Dimming LEDs, controlling motor speed.  

**Example: LED Fading**
```c
const int ledPin = 9; // PWM pin

void setup() {
  pinMode(ledPin, OUTPUT);
}

void loop() {
  analogWrite(ledPin, 128); // 50% brightness
  delay(1000);
  analogWrite(ledPin, 255); // Full brightness
  delay(1000);
}
```

**Diagram Description:** Arduino pin 9 → 220Ω resistor → LED anode → cathode → GND.  

**Technical Note:** PWM is not true analog—it’s a square wave with varying duty cycle. Check pin markings (~) for PWM capability.

---

### 4️⃣ Interrupts
Interrupts let Arduino respond instantly to events (e.g., button press), pausing `loop()` to run a special function.  

- **Function:** `attachInterrupt(digitalPinToInterrupt(pin), ISR, mode)`  
  - `pin`: Interrupt-capable (Uno: pins 2, 3).  
  - `ISR`: Interrupt Service Routine (void function, no parameters/return).  
  - `mode`: `LOW`, `CHANGE`, `RISING`, `FALLING`.  
- **Example:**
```c
const int buttonPin = 2;
volatile bool ledState = false;

void setup() {
  pinMode(13, OUTPUT);
  pinMode(buttonPin, INPUT_PULLUP);
  attachInterrupt(digitalPinToInterrupt(buttonPin), toggleLED, FALLING);
}

void loop() {
  digitalWrite(13, ledState);
}

void toggleLED() {
  ledState = !ledState; // Toggle state
}
```

**Technical Note:** Use `volatile` for variables in ISRs. Keep ISRs short to avoid delays. Max 2 interrupts on Uno.

---

### 5️⃣ Timing: `delay()` vs. `millis()`
Timing is critical in Arduino to keep systems responsive.  

- **`delay(ms)`:** Pauses execution (blocking). Fine for simple sketches, but stops other tasks.  
- **`millis()`:** Returns milliseconds since startup (non-blocking). Use for multitasking.  

**Non-Blocking Example:**
```c
unsigned long previousMillis = 0;
const long interval = 1000;

void loop() {
  unsigned long currentMillis = millis();
  if (currentMillis - previousMillis >= interval) {
    previousMillis = currentMillis;
    digitalWrite(13, !digitalRead(13)); // Toggle LED
  }
}
```

**Arduino Tip:** Avoid `delay()` in complex projects to allow simultaneous tasks (e.g., reading sensors while blinking LEDs).

---

## 🖌️ Lab: Hands-On Projects
Let’s bring I/O to life with two projects: a **potentiometer-controlled LED brightness** (analog input/output) and a **traffic light simulator** (digital output, timing).  

### Project 1: Potentiometer-Controlled LED Brightness 🎛️💡
**Goal:** Adjust LED brightness using a potentiometer with `analogRead()` and `analogWrite()`.  
**Components:** Arduino Uno, LED, 220Ω resistor, 10kΩ potentiometer, breadboard, jumper wires.  
**Circuit Setup:**  
- LED: Pin 9 (PWM) → 220Ω resistor → LED anode → cathode → GND.  
- Potentiometer: Middle pin to A0, outer pins to 5V and GND.  
**Circuit Diagram Description:** Potentiometer wiper to A0, LED on pin 9 with resistor to GND.  
**Code Outline:**  
- Read potentiometer value (0-1023).  
- Map to PWM range (0-255) using `map()`.  
- Set LED brightness with `analogWrite()`.  

**Safety Note:** Ensure PWM pin (marked ~). Resistor protects LED from overcurrent.  

---

### Project 2: Traffic Light Simulator 🚦
**Goal:** Simulate a traffic light sequence (red, green, yellow) using digital outputs and timing.  
**Components:** Arduino Uno, LEDs (red, green, yellow), 220Ω resistors (3), breadboard, jumper wires.  
**Circuit Setup:**  
- Red LED: Pin 11 → 220Ω → GND.  
- Green LED: Pin 10 → 220Ω → GND.  
- Yellow LED: Pin 9 → 220Ω → GND.  
**Circuit Diagram Description:** Three LEDs connected to pins 9-11, each with a 220Ω resistor to GND.  
**Code Outline:**  
- Set pins as outputs in `setup()`.  
- Use `digitalWrite()` and `delay()` for sequence (e.g., red 5s, green 5s, yellow 2s).  
- Bonus: Try `millis()` for non-blocking timing.  

**Engagement Prompt:** Can you add a button to pause the traffic light? Test it in Tinkercad! 💬

---

## 🔍 Key Concepts Recap
| Concept            | Description                              | Arduino Example                     |
|--------------------|------------------------------------------|-------------------------------------|
| **Digital I/O**    | On/off signals (HIGH/LOW)               | `digitalWrite(13, HIGH)`           |
| **Analog Input**   | Read 0-5V as 0-1023                    | `analogRead(A0)`                   |
| **PWM (Analog Output)** | Simulate analog with duty cycle     | `analogWrite(9, 128)`             |
| **Interrupts**     | Instant event response                  | `attachInterrupt(2, ISR, FALLING)` |
| **Timing**         | Control execution flow                  | `millis()` for non-blocking        |

**Technical Notes:**  
- **PWM Frequency:** ~490Hz on Uno. Adjust with timers for advanced projects.  
- **ADC Resolution:** 10-bit (1024 levels). Noise may affect `analogRead()`.  
- **Interrupt Pins:** Uno supports interrupts on pins 2 and 3 only.  

---

## 🎯 Summary & Takeaways
- **Digital I/O:** Perfect for simple on/off control (buttons, LEDs).  
- **Analog I/O:** Enables nuanced input (sensors) and output (PWM for dimming).  
- **Interrupts:** Make your Arduino react instantly to events.  
- **Timing:** Use `millis()` to keep projects responsive.  
- **Hands-On Wins:** Potentiometer and traffic light projects show how I/O brings hardware to life.  

**Quick Tip:** Test circuits in Tinkercad first to avoid wiring errors!  

---

## 📚 Resources & Homework
- **Reference:** `https://www.arduino.cc/reference/en/` (check `analogRead`, `analogWrite`, `millis`).  
- **Tinkercad:** Simulate a fading LED with two potentiometers.  
- **Video Tutorial:** Search “Arduino PWM Tutorial” on YouTube.  
- **Homework:**  
  1. Build the potentiometer-controlled LED brightness circuit (or simulate).  
  2. Code the traffic light simulator with 5s red, 5s green, 2s yellow.  
  3. Bonus: Rewrite traffic light using `millis()` for non-blocking timing. Submit code/screenshots!  

**Keep Creating!** You’re now controlling hardware like a pro. Next week, we’ll dive into sensors and data acquisition. Questions? Let’s brainstorm! 😄
