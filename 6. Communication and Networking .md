# Module 6 Lecture: Communication and Networking in Arduino üì°üåê
ü§ñ **Instructor:** Md. Hassanul Karim Roni, Assistant Professor, EEE, HSTU, Dinajpur, BD

## üöÄ Projects You'll Build Today
- **Wireless Temperature Logger:** Create a system that logs temperature data and sends it to a cloud server like ThingSpeak for real-time monitoring!  
- **Bonus Challenge:** Add a local SD card backup or control a device via Bluetooth. Ready to connect your Arduino to the world? Let‚Äôs dive in!

---

## üéØ Lecture Objectives
- Understand I2C and SPI protocols for multi-device communication.  
- Explore wireless communication with Bluetooth (HC-05) and WiFi (ESP8266).  
- Learn data logging with an SD card module.  
- Master IoT basics by sending sensor data to a cloud platform (e.g., ThingSpeak).  
- Build a wireless temperature logger to apply communication skills.  

**Duration:** ~3 hours (1.5 hours lecture + 1.5 hours lab, split over Weeks 6-7).  
**Tools Needed:** Arduino Uno, USB cable, DHT11 sensor, HC-05 Bluetooth module, ESP8266 WiFi module, SD card module, microSD card, 10kŒ© resistor, breadboard, jumper wires, 5V external power (optional), laptop with Arduino IDE, ThingSpeak account, optional: Tinkercad Circuits (limited wireless support).  

---

## üõ†Ô∏è Why Communication and Networking Matter
Arduino projects shine when devices talk to each other or the internet. **I2C and SPI** connect multiple sensors/displays, **Bluetooth and WiFi** enable wireless control, **SD cards** store data locally, and **IoT** connects your project to the cloud. These skills let you build smart systems like remote weather stations or IoT home automation. Let‚Äôs make your Arduino talkative! üì°

---

## üìö Communication and Networking Concepts

### 1Ô∏è‚É£ I2C Protocol
**I2C (Inter-Integrated Circuit)** connects multiple devices using two wires: SDA (data) and SCL (clock).  
- **Function:** `Wire.h` library (`Wire.begin()`, `Wire.write()`, `Wire.read()`).  
- **Pins (Uno):** A4 (SDA), A5 (SCL).  
- **Use Case:** Connect multiple sensors (e.g., BME280) or displays (e.g., OLED SSD1306).  
- **Example: Read BME280 Sensor**
  ```c
  #include <Wire.h>
  #include <Adafruit_BME280.h>
  Adafruit_BME280 bme;
  void setup() {
    Wire.begin();
    bme.begin(0x76); // I2C address
  }
  void loop() {
    float temp = bme.readTemperature();
  }
  ```
- **Diagram Description:** BME280 SDA to A4, SCL to A5, VCC to 3.3V/5V, GND to GND; pull-up resistors (4.7kŒ©) on SDA/SCL.

**Technical Note:** I2C supports up to 127 devices, each with a unique address (e.g., 0x76 for BME280). Max speed: 400kHz (fast mode).

---

### 2Ô∏è‚É£ SPI Protocol
**SPI (Serial Peripheral Interface)** uses four wires for faster communication: MOSI, MISO, SCLK, SS.  
- **Function:** `SPI.h` library (`SPI.begin()`, `SPI.transfer()`).  
- **Pins (Uno):** 10 (SS), 11 (MOSI), 12 (MISO), 13 (SCLK).  
- **Use Case:** SD card modules, high-speed displays.  
- **Example: SPI Device Communication**
  ```c
  #include <SPI.h>
  const int ssPin = 10;
  void setup() {
    SPI.begin();
    pinMode(ssPin, OUTPUT);
  }
  void loop() {
    digitalWrite(ssPin, LOW); // Select device
    SPI.transfer(0xFF); // Send data
    digitalWrite(ssPin, HIGH); // Deselect
  }
  ```
- **Diagram Description:** SD card module MOSI to pin 11, MISO to 12, SCLK to 13, SS to 10, VCC to 5V, GND to GND.

**Technical Note:** SPI is faster than I2C (up to 8MHz on Uno) but needs more pins. SS pin selects one device at a time.

---

### 3Ô∏è‚É£ Wireless Communication: Bluetooth (HC-05)
**HC-05** enables short-range (~10m) serial communication with devices like smartphones.  
- **Setup:** Connect TXD to Arduino RX (pin 10), RXD to TX (pin 11), VCC to 3.3V/5V, GND to GND.  
- **Library:** `SoftwareSerial.h` for non-Serial pins.  
- **Example:**
  ```c
  #include <SoftwareSerial.h>
  SoftwareSerial bt(10, 11); // RX, TX
  void setup() {
    bt.begin(9600); // Default baud
    Serial.begin(9600);
  }
  void loop() {
    if (bt.available()) {
      Serial.write(bt.read()); // Relay data to Serial Monitor
    }
  }
  ```
- **Diagram Description:** HC-05 TXD to Arduino pin 10, RXD to pin 11, VCC to 5V, GND to GND.

**Technical Note:** Default baud rate is 9600. Use AT commands to configure (e.g., name, password). Avoid pins 0/1 for Bluetooth.

---

### 4Ô∏è‚É£ Wireless Communication: WiFi (ESP8266)
**ESP8266** connects Arduino to the internet for IoT applications.  
- **Setup:** Use as a shield or via Serial (TX/RX). Requires external 3.3V power.  
- **Library:** `ESP8266WiFi.h` or AT commands.  
- **Example: Connect to WiFi**
  ```c
  #include <ESP8266WiFi.h>
  const char* ssid = "yourSSID";
  const char* password = "yourPassword";
  void setup() {
    Serial.begin(115200);
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
      delay(500);
    }
  }
  ```
- **Diagram Description:** ESP8266 TX to Arduino RX (pin 10), RX to TX (pin 11), VCC to 3.3V, GND to GND.

**Technical Note:** ESP8266 needs 3.3V logic; use a level shifter if connecting to Uno‚Äôs 5V pins. High current (~200mA) requires external power.

---

### 5Ô∏è‚É£ Data Logging: SD Card Module
SD cards store sensor data locally using SPI.  
- **Library:** `SD.h` (`SD.begin()`, `SD.open()`, `SD.write()`).  
- **Example:**
  ```c
  #include <SD.h>
  File myFile;
  void setup() {
    SD.begin(10); // CS pin
    myFile = SD.open("data.txt", FILE_WRITE);
    myFile.println("Temp: 25C");
    myFile.close();
  }
  ```
- **Diagram Description:** SD module MOSI to pin 11, MISO to 12, SCLK to 13, CS to 10, VCC to 5V, GND to GND.

**Technical Note:** Use FAT16/FAT32 formatted microSD cards. Check for file open/close to avoid corruption.

---

### 6Ô∏è‚É£ IoT Basics: Sending Data to Cloud (ThingSpeak)
**ThingSpeak** is a free IoT platform for logging and visualizing sensor data.  
- **Setup:** Create a ThingSpeak account, get API key.  
- **Example: Send Temperature to ThingSpeak**
  ```c
  #include <ESP8266WiFi.h>
  #include <ThingSpeak.h>
  WiFiClient client;
  const char* apiKey = "yourAPIKey";
  void setup() {
    WiFi.begin("ssid", "password");
    ThingSpeak.begin(client);
  }
  void loop() {
    ThingSpeak.writeField(1, 25.5); // Field 1, temp
    delay(15000); // ThingSpeak free limit: 15s
  }
  ```
- **Diagram Description:** Same as ESP8266 setup.

**Technical Note:** ThingSpeak free tier limits updates to every 15 seconds. Use `HTTPClient` for custom servers.

---

## üñåÔ∏è Lab: Wireless Temperature Logger üå°Ô∏èüì°
**Goal:** Build a system that reads temperature from a DHT11 sensor, logs it locally on an SD card, and sends it to ThingSpeak via ESP8266.  
**Components:** Arduino Uno, DHT11 sensor, ESP8266 WiFi module, SD card module, microSD card, 10kŒ© resistor, breadboard, jumper wires, 3.3V/5V external power.  
**Circuit Setup:**  
- DHT11: Data to pin 2, VCC to 5V, GND to GND, 10kŒ© pull-up resistor.  
- ESP8266: TX to pin 10, RX to pin 11, VCC to 3.3V, GND to GND.  
- SD Card: MOSI to pin 11, MISO to 12, SCLK to 13, CS to 10, VCC to 5V, GND to GND.  
**Circuit Diagram Description:** DHT11 to pin 2 with pull-up; ESP8266 to pins 10/11; SD module to SPI pins.  
**Code Outline:**  
- Use `DHT.h`, `SD.h`, `ESP8266WiFi.h`, `ThingSpeak.h`.  
- Read temperature with `dht.readTemperature()`.  
- Log to SD card with `SD.open()`, `SD.println()`.  
- Send to ThingSpeak with `ThingSpeak.writeField()`.  

**Safety Note:** Use 3.3V for ESP8266; ensure stable power for SD module. Test connections in Tinkercad (limited WiFi support).  

**Challenge:** Add Bluetooth (HC-05) to send data to a phone app or log humidity too.

---

## üîç Key Concepts Recap
| Concept            | Description                              | Arduino Example                     |
|--------------------|------------------------------------------|-------------------------------------|
| **I2C**            | 2-wire multi-device communication        | `Wire.h` for BME280                |
| **SPI**            | 4-wire high-speed communication         | `SD.h` for SD card                |
| **Bluetooth**      | Short-range wireless                    | `SoftwareSerial` for HC-05         |
| **WiFi**           | Internet connectivity                   | `ESP8266WiFi.h` for IoT           |
| **IoT**            | Cloud data logging                      | `ThingSpeak.h` for cloud          |

**Technical Notes:**  
- **Pin Conflicts:** Avoid SPI pins (10-13) for other tasks when using SD.  
- **Power:** ESP8266 draws ~200mA; use external 3.3V supply.  
- **SRAM:** Libraries like `ESP8266WiFi` use ~1KB; monitor usage.  

---

## üéØ Summary & Takeaways
- **Communication is Key:** I2C/SPI connect devices; Bluetooth/WiFi enable wireless.  
- **Data Logging:** SD cards store data locally for reliability.  
- **IoT Power:** ThingSpeak brings your projects to the cloud.  
- **Hands-On Wins:** The temperature logger combines sensors, storage, and IoT.  
- **Next Steps:** Integrate actuators (Module 5) with networking for smart systems.  

**Quick Tip:** Test wiring in Tinkercad and verify WiFi credentials before uploading!  

---

## üìö Resources & Homework
- **Reference:** `https://www.arduino.cc/reference/en/` (check `Wire`, `SPI`, `SoftwareSerial`).  
- **Tutorials:** Adafruit ESP8266 (`https://learn.adafruit.com/esp8266`), ThingSpeak setup (`https://thingspeak.com`).  
- **Video Tutorial:** Search ‚ÄúArduino ThingSpeak Tutorial‚Äù on YouTube.  
- **Homework:**  
  1. Build the wireless temperature logger with DHT11, SD card, and ThingSpeak (or simulate parts in Tinkercad).  
  2. Log temperature every 30 seconds to SD and ThingSpeak.  
  3. Bonus: Use HC-05 to send data to a phone app. Submit code/screenshots!  

**Keep Connecting!** You‚Äôre now linking Arduino to the world. Next week, we‚Äôll optimize code and explore advanced topics. Questions? Let‚Äôs chat! üòÑ
